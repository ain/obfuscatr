/*! obfuscatr - v1.3.0 - 2014-02-13
* http://obfuscatr.flashbit.net
* Copyright (c) 2014 Ain Tohvri; Licensed GPL */
function Obfuscatr(){this.result=null,this.stage=0,this.front=null,this.fliprollie=null,this.flip=null,this.field=null,this.btn=null,this.msg=null,this.box=null,this.logo=null,this.linkChangelog=null,this.back=null,this.btnDone=null,this.flipShown=!1,this.animation={duration:0,starttime:0,to:1,now:0,from:0,firstElement:null,timer:null}}String.prototype.reverse=function(){return this.split("").reverse().join("")},Function.prototype.inScope=function(a){var b=this;return function(){return b.apply(a,arguments)}},Obfuscatr.prototype.init=function(){this.front=document.getElementById("front"),this.fliprollie=document.getElementById("fliprollie"),this.flip=document.getElementById("flip"),this.field=document.getElementById("field"),this.btn=document.getElementById("btn"),this.msg=document.getElementById("msg"),this.box=document.getElementById("box"),createGenericButton(this.btn,"Obfuscate!",this.obfuscate.inScope(this)),this.logo=document.getElementById("logo"),this.linkChangelog=document.getElementById("link-changelog"),this.back=document.getElementById("back"),this.btnDone=document.getElementById("btn-done"),createGenericButton(this.btnDone,"Done",this.hideBack.inScope(this)),this.toggle(),this.addEventListeners()},Obfuscatr.prototype.addEventListeners=function(){this.front.onmousemove=this.mousemove.inScope(this),this.front.onmouseout=this.mouseexit.inScope(this),this.logo.onclick=this.launchSite.inScope(this),this.linkChangelog.onclick=this.launchChangelog.inScope(this),this.btnDone.onclick=this.hideBack.inScope(this),this.flip.onclick=this.showBack.inScope(this),this.flip.onmouseover=this.enterflip.inScope(this),this.flip.onmouseout=this.exitflip.inScope(this)},Obfuscatr.prototype.isValidEmail=function(a){var b=/^([\w\-\.\+])+\@([\w\-]+\.)+([\w]{2,})+$/;return b.test(a)},Obfuscatr.prototype.errorHandle=function(a){var b;switch(a){case 1:b="Please enter email to obfuscate.";break;case 2:b="Invalid email. Please fix.";break;case 3:this.box.value=this.email,b="Done. Email copied to clipboard."}this.field.style.display="none",this.msg.innerHTML=b,this.msg.style.display="block",this.btn.innerHTML="",createGenericButton(this.btn,"Back",this.goBack.inScope(this))},Obfuscatr.prototype.obfuscate=function(){var a=this.box.value;0===a.length?this.errorHandle(1):this.isValidEmail(a)?(this.result="<a href=\"javascript:void(0)\"; onclick=\"window.location='mailto:'+this.innerHTML.split('').reverse().join('');\" style=\"direction:rtl;unicode-bidi:bidi-override;\">"+a.reverse()+"</a>",this.btn.innerHTML="",createGenericButton(this.btn,"Copy",this.copy.inScope(this)),this.stage=1,this.box.value=this.result,this.toggle()):this.errorHandle(2)},Obfuscatr.prototype.copy=function(){if(window.widget){var a=this.result.replace(/"/g,'\\"');window.widget.system('/bin/echo -n "'+a+'" | /usr/bin/pbcopy',null),this.errorHandle(3)}},Obfuscatr.prototype.goBack=function(){this.btn.innerHTML="",this.msg.innerHTML="",this.field.style.display="block",createGenericButton(this.btn,"Obfuscate!",this.obfuscate.inScope(this)),this.toggle()},Obfuscatr.prototype.launchChangelog=function(){window.widget&&window.widget.openURL("http://obfuscatr.flashbit.net/download.html#changelog")},Obfuscatr.prototype.launchSite=function(){window.widget&&window.widget.openURL("http://obfuscatr.flashbit.net")},Obfuscatr.prototype.toggle=function(){this.box.focus(),this.box.select()},Obfuscatr.prototype.proceed=function(){return""===this.box.value?!1:(1===this.stage?this.copy():this.obfuscate(),!0)},Obfuscatr.prototype.showBack=function(){window.widget&&window.widget.prepareForTransition("ToBack"),this.front.style.display="none",this.back.style.display="block",window.widget&&setTimeout(function(){window.widget&&widget.performTransition()},0)},Obfuscatr.prototype.hideBack=function(){window.widget&&window.widget.prepareForTransition("ToFront"),this.front.style.display="block",this.back.style.display="none",window.widget&&setTimeout(function(){window.widget&&widget.performTransition()},0)},Obfuscatr.prototype.limit_3=function(a,b,c){return b>a?b:a>c?c:a},Obfuscatr.prototype.computeNextFloat=function(a,b,c){return a+(b-a)*c},Obfuscatr.prototype.enterflip=function(){this.fliprollie.style.display="block"},Obfuscatr.prototype.exitflip=function(){this.fliprollie.style.display="none"},Obfuscatr.prototype.animate=function(){var a,b,c=(new Date).getTime();a=this.limit_3(c-this.animation.starttime,0,this.animation.duration),a>=this.animation.duration?(clearInterval(this.animation.timer),this.animation.timer=null,this.animation.now=this.animation.to):(b=.5-.5*Math.cos(Math.PI*a/this.animation.duration),this.animation.now=this.computeNextFloat(this.animation.from,this.animation.to,b)),this.animation.firstElement.style.opacity=this.animation.now},Obfuscatr.prototype.mousemove=function(){this.flipShown||(null!=this.animation.timer&&(clearInterval(this.animation.timer),this.animation.timer=null),this.animation.duration=500,this.animation.starttime=(new Date).getTime()-13,this.animation.firstElement=this.flip,this.animation.timer=setInterval(this.animate.inScope(this),13),this.animation.from=this.animation.now,this.animation.to=1,this.animate(this),this.flipShown=!0)},Obfuscatr.prototype.mouseexit=function(){this.flipShown&&(null!=this.animation.timer&&(clearInterval(this.animation.timer),this.animation.timer=null),this.animation.duration=500,this.animation.starttime=(new Date).getTime()-13,this.animation.firstElement=this.flip,this.animation.timer=setInterval(this.animate.inScope(this),13),this.animation.from=this.animation.now,this.animation.to=0,this.animate(),this.flipShown=!1)};